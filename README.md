# Memento プログラミング言語

Mementoは関数型の特徴を持ち、エフェクトシステムを統合した実験的プログラミング言語です。

## 特徴

- **関数型パラダイム**: すべてが式であり、ラムダ計算に基づく
- **型システム**: オプショナルな型注釈と型推論をサポート
- **エフェクトシステム**: 副作用を追跡・処理する機能
- **パイプライン演算子**: データフローを直感的に表現
- **Thunk-based評価**: 遅延評価によるエフェクト処理

## 言語仕様

### 基本構文

```
// 値の束縛
42 -> x;                   // xに42を束縛

// 型注釈
42 -> x : number;          // 明示的な型注釈
true -> flag : bool;       // 真偽値型

// ラムダ式（無名関数）
(x; x + 1) -> increment;   // 引数x、本体はx+1
(n : number; n * 2) -> double; // 型注釈付きラムダ式

// 関数適用
x -> increment;            // incrementにxを適用
5 -> double -> increment;  // 合成関数（5を倍にしてから1増やす）

// 条件分岐
if (x > 10) then x else 5;
```

### 型システム

Mementoは以下の型をサポートしています：

- `number`: 数値型
- `bool`: 真偽値型
- 関数型: `T1 -> T2`（T1からT2への関数）

型注釈は省略可能で、多くの場合型推論が働きます：

```
// 型注釈あり
42 -> x : number;

// 型注釈なし（numberと推論される）
10 -> y;

// 関数の型も推論される
(n; n * 2) -> double;  // number -> number と推論
```

### エフェクトシステム

Mementoはエフェクトを追跡・処理する機能を持っています。現在サポートされているエフェクト：

- `ZeroDiv`: ゼロ除算の可能性

エフェクトは関数を通じて伝播します：

```
// エフェクトを持つ関数
(a; a / 2) -> halve;   // ZeroDivエフェクトを持つ

// エフェクトの伝播
x -> halve;            // halveのエフェクトを引き継ぐ
```

### doオペレーション

`do`キーワードを使って特定のエフェクトを発生させることができます：

```
// throwエフェクトの発生
do throw;

// 条件によるエフェクト
if (x <= 0) then do throw else x;
```

## 使用例

### 基本的な値と演算

```
// 変数定義
42 -> x : number;
10 -> y : number;

// 簡単な演算
x + y;        // 52
x * y;        // 420
```

### 関数定義と適用

```
// 関数定義
(n : number; n + 1) -> increment;
(n : number; n * 2) -> double;

// 関数適用
5 -> increment;        // 6
5 -> double;           // 10

// 関数合成
5 -> double -> increment;  // 11
```

### 条件分岐

```
// 条件式
if (x > y) then x else y;

// 条件分岐を含む関数
(val; if (val > 10) then (val + 10) else (val - 5)) -> conditional;
```

### エフェクト処理

```
// エフェクトを持つ関数
(a; a / 2) -> halve;

// エフェクトの伝播
x -> halve;

// doによるエフェクト
do throw -> errorVal;
```

## ビルドと実行

```bash
# コンパイラのビルド
./build.sh build

# ファイルのコンパイル
./build.sh compile examples/thunk.mmt

# コンパイル＆実行
./build.sh examples/thunk.mmt
```

## 今後の開発予定

- より豊富なデータ型（リスト、タプル、レコードなど）
- カスタムエフェクトの定義
- より強力な型システム（多相型、代数的データ型）
- ライブラリシステム
